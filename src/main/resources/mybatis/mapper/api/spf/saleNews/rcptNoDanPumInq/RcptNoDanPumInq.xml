<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="com.saydept.api.spf.saleNews.rcptNoDanPumInq.RcptNoDanPumInqMapper">


	<select id="getRcptNoDanPumInqlist"
		parameterType="com.saydept.api.spf.saleNews.rcptNoDanPumInq.model.RcptNoDanPumInqParamModel"
		resultType="com.saydept.api.spf.saleNews.rcptNoDanPumInq.model.RcptNoDanPumInqModel">

SELECT P01HSYY||P01HSMM||P01HSDD maeDate
        ,P01HRNO regiNo
		,CASE WHEN A.MS0510 != '' THEN TRIM(A.MS0510) ELSE TRIM(replace(PD1806,'　','')) END regiNm
        ,P01HTNO rcptNo
        ,P01HSGU hsGu
        ,CASE WHEN P01HSGU = '0' THEN '정상' WHEN P01HSGU = '1' THEN '반품' WHEN P01HSGU = '2' THEN '오타' WHEN P01HSGU = '3' THEN '선수발생' WHEN P01HSGU = '4' THEN '선수취소' WHEN P01HSGU = '5' THEN '선수결말' WHEN P01HSGU = '6' THEN '공병회수' ELSE '' END hsGuNm
        ,CASE WHEN P01HSGU = '0' THEN CASE WHEN SUBSTR(P01DATA1,1,1) = '1' THEN INT(SUBSTR(P01DATA1,24,8)) WHEN SUBSTR(P01DATA2,1,1) = '1' THEN INT(SUBSTR(P01DATA2,24,8)) WHEN SUBSTR(P01DATA3,1,1) = '1' THEN INT(SUBSTR(P01DATA3,24,8)) WHEN SUBSTR(P01DATA4,1,1) = '1' THEN INT(SUBSTR(P01DATA4,24,8)) WHEN SUBSTR(P01DATA5,1,1) = '1' THEN INT(SUBSTR(P01DATA5,24,8)) WHEN SUBSTR(P01DATA6,1,1) = '1' THEN INT(SUBSTR(P01DATA6,24,8)) WHEN SUBSTR(P01DATA7,1,1) = '1' THEN INT(SUBSTR(P01DATA7,24,8)) WHEN SUBSTR(P01DATA8,1,1) = '1' THEN INT(SUBSTR(P01DATA8,24,8)) WHEN SUBSTR(P01DATA9,1,1) = '1' THEN INT(SUBSTR(P01DATA9,24,8)) ELSE 0 END WHEN P01HSGU = '1' THEN (CASE WHEN SUBSTR(P01DATA1,1,1) = '1' THEN INT(SUBSTR(P01DATA1,24,8)) WHEN SUBSTR(P01DATA2,1,1) = '1' THEN INT(SUBSTR(P01DATA2,24,8)) WHEN SUBSTR(P01DATA3,1,1) = '1' THEN INT(SUBSTR(P01DATA3,24,8)) WHEN SUBSTR(P01DATA4,1,1) = '1' THEN INT(SUBSTR(P01DATA4,24,8)) WHEN SUBSTR(P01DATA5,1,1) = '1' THEN INT(SUBSTR(P01DATA5,24,8)) WHEN SUBSTR(P01DATA6,1,1) = '1' THEN INT(SUBSTR(P01DATA6,24,8)) WHEN SUBSTR(P01DATA7,1,1) = '1' THEN INT(SUBSTR(P01DATA7,24,8)) WHEN SUBSTR(P01DATA8,1,1) = '1' THEN INT(SUBSTR(P01DATA8,24,8)) WHEN SUBSTR(P01DATA9,1,1) = '1' THEN INT(SUBSTR(P01DATA9,24,8)) ELSE 0 END) * -1 END danPum
        
        ,CASE WHEN P01HSGU = '0' THEN CASE WHEN SUBSTR(P01DATA1,1,1) = '1' THEN INT(SUBSTR(P01DATA1,32,3)) WHEN SUBSTR(P01DATA2,1,1) = '1' THEN INT(SUBSTR(P01DATA2,32,3)) WHEN SUBSTR(P01DATA3,1,1) = '1' THEN INT(SUBSTR(P01DATA3,32,3)) WHEN SUBSTR(P01DATA4,1,1) = '1' THEN INT(SUBSTR(P01DATA4,32,3)) WHEN SUBSTR(P01DATA5,1,1) = '1' THEN INT(SUBSTR(P01DATA5,32,3)) WHEN SUBSTR(P01DATA6,1,1) = '1' THEN INT(SUBSTR(P01DATA6,32,3)) WHEN SUBSTR(P01DATA7,1,1) = '1' THEN INT(SUBSTR(P01DATA7,32,3)) WHEN SUBSTR(P01DATA8,1,1) = '1' THEN INT(SUBSTR(P01DATA8,32,3)) WHEN SUBSTR(P01DATA9,1,1) = '1' THEN INT(SUBSTR(P01DATA9,32,3)) ELSE 0 END WHEN P01HSGU = '1' THEN (CASE WHEN SUBSTR(P01DATA1,1,1) = '1' THEN INT(SUBSTR(P01DATA1,32,3)) WHEN SUBSTR(P01DATA2,1,1) = '1' THEN INT(SUBSTR(P01DATA2,32,3)) WHEN SUBSTR(P01DATA3,1,1) = '1' THEN INT(SUBSTR(P01DATA3,32,3)) WHEN SUBSTR(P01DATA4,1,1) = '1' THEN INT(SUBSTR(P01DATA4,32,3)) WHEN SUBSTR(P01DATA5,1,1) = '1' THEN INT(SUBSTR(P01DATA5,32,3)) WHEN SUBSTR(P01DATA6,1,1) = '1' THEN INT(SUBSTR(P01DATA6,32,3)) WHEN SUBSTR(P01DATA7,1,1) = '1' THEN INT(SUBSTR(P01DATA7,32,3)) WHEN SUBSTR(P01DATA8,1,1) = '1' THEN INT(SUBSTR(P01DATA8,32,3)) WHEN SUBSTR(P01DATA9,1,1) = '1' THEN INT(SUBSTR(P01DATA9,32,3)) ELSE 0 END) * -1 END cntPum
        ,CASE WHEN P01HSGU = '0' THEN CASE WHEN SUBSTR(P01DATA1,1,1) = '1' THEN INT(SUBSTR(P01DATA1,38,7)) WHEN SUBSTR(P01DATA2,1,1) = '1' THEN INT(SUBSTR(P01DATA2,38,7)) WHEN SUBSTR(P01DATA3,1,1) = '1' THEN INT(SUBSTR(P01DATA3,38,7)) WHEN SUBSTR(P01DATA4,1,1) = '1' THEN INT(SUBSTR(P01DATA4,38,7)) WHEN SUBSTR(P01DATA5,1,1) = '1' THEN INT(SUBSTR(P01DATA5,38,7)) WHEN SUBSTR(P01DATA6,1,1) = '1' THEN INT(SUBSTR(P01DATA6,38,7)) WHEN SUBSTR(P01DATA7,1,1) = '1' THEN INT(SUBSTR(P01DATA7,38,7)) WHEN SUBSTR(P01DATA8,1,1) = '1' THEN INT(SUBSTR(P01DATA8,38,7)) WHEN SUBSTR(P01DATA9,1,1) = '1' THEN INT(SUBSTR(P01DATA9,38,7)) ELSE 0 END WHEN P01HSGU = '1' THEN (CASE WHEN SUBSTR(P01DATA1,1,1) = '1' THEN INT(SUBSTR(P01DATA1,38,7)) WHEN SUBSTR(P01DATA2,1,1) = '1' THEN INT(SUBSTR(P01DATA2,38,7)) WHEN SUBSTR(P01DATA3,1,1) = '1' THEN INT(SUBSTR(P01DATA3,38,7)) WHEN SUBSTR(P01DATA4,1,1) = '1' THEN INT(SUBSTR(P01DATA4,38,7)) WHEN SUBSTR(P01DATA5,1,1) = '1' THEN INT(SUBSTR(P01DATA5,38,7)) WHEN SUBSTR(P01DATA6,1,1) = '1' THEN INT(SUBSTR(P01DATA6,38,7)) WHEN SUBSTR(P01DATA7,1,1) = '1' THEN INT(SUBSTR(P01DATA7,38,7)) WHEN SUBSTR(P01DATA8,1,1) = '1' THEN INT(SUBSTR(P01DATA8,38,7)) WHEN SUBSTR(P01DATA9,1,1) = '1' THEN INT(SUBSTR(P01DATA9,38,7)) ELSE 0 END) * -1 END halGum
        ,SUBSTR(P01DATA1,1,1) c_1
		,CASE WHEN SUBSTR(P01DATA1,1,1) = '1' THEN SUBSTR(P01DATA1,17,5) WHEN SUBSTR(P01DATA2,1,1) = '1' THEN SUBSTR(P01DATA2,17,5) WHEN SUBSTR(P01DATA3,1,1) = '1' THEN SUBSTR(P01DATA3,17,5) WHEN SUBSTR(P01DATA4,1,1) = '1' THEN SUBSTR(P01DATA4,17,5) WHEN SUBSTR(P01DATA5,1,1) = '1' THEN SUBSTR(P01DATA5,17,5) WHEN SUBSTR(P01DATA6,1,1) = '1' THEN SUBSTR(P01DATA6,17,5) WHEN SUBSTR(P01DATA7,1,1) = '1' THEN SUBSTR(P01DATA7,17,5) WHEN SUBSTR(P01DATA8,1,1) = '1' THEN SUBSTR(P01DATA8,17,5) WHEN SUBSTR(P01DATA9,1,1) = '1' THEN SUBSTR(P01DATA9,17,5) ELSE '' END clsNo
        ,CASE WHEN SUBSTR(P01DATA1,1,1) = '1' THEN SUBSTR(P01DATA1,4,13) WHEN SUBSTR(P01DATA2,1,1) = '1' THEN SUBSTR(P01DATA2,4,13) WHEN SUBSTR(P01DATA3,1,1) = '1' THEN SUBSTR(P01DATA3,4,13) WHEN SUBSTR(P01DATA4,1,1) = '1' THEN SUBSTR(P01DATA4,4,13) WHEN SUBSTR(P01DATA5,1,1) = '1' THEN SUBSTR(P01DATA5,4,13) WHEN SUBSTR(P01DATA6,1,1) = '1' THEN SUBSTR(P01DATA6,4,13) WHEN SUBSTR(P01DATA7,1,1) = '1' THEN SUBSTR(P01DATA7,4,13) WHEN SUBSTR(P01DATA8,1,1) = '1' THEN SUBSTR(P01DATA8,4,13) WHEN SUBSTR(P01DATA9,1,1) = '1' THEN SUBSTR(P01DATA9,4,13) ELSE '' END danCode
        ,P01HSG1 hsG1
        ,CASE WHEN P01HSG1='1' THEN '현금' WHEN P01HSG1='2' THEN '자사카드' WHEN P01HSG1='3' THEN '타사카드' WHEN P01HSG1='4' THEN '외상' WHEN P01HSG1='5' THEN '특판' WHEN P01HSG1='6' THEN '직불' WHEN P01HSG1='7' THEN 'COD' WHEN P01HSG1='8' THEN '자사상품' WHEN P01HSG1='9' THEN '타사상품' WHEN P01HSG1='A' THEN '자상환불' WHEN P01HSG1='B' THEN '선수현금' WHEN P01HSG1='C' THEN '선수카드' WHEN P01HSG1='D' THEN '선수상품' WHEN P01HSG1='E' THEN '장바구니' WHEN P01HSG1='F' THEN '직불카드' WHEN P01HSG1='G' THEN '사용매출' WHEN P01HSG1='H' THEN 'POINT 결제' WHEN P01HSG1='J' THEN '현대상품' WHEN P01HSG1='K' THEN 'SK상품' WHEN P01HSG1='L' THEN 'LG상품' WHEN P01HSG1='I' THEN '제휴환불' WHEN P01HSG1!='' THEN '기타' ELSE '' END hsG1Nm
        ,P01HSM1 hsM1
        ,P01HSG2 hsG2
        ,CASE WHEN P01HSG2='1' THEN '현금' WHEN P01HSG2='2' THEN '자사카드' WHEN P01HSG2='3' THEN '타사카드' WHEN P01HSG2='4' THEN '외상' WHEN P01HSG2='5' THEN '특판' WHEN P01HSG2='6' THEN '직불' WHEN P01HSG2='7' THEN 'COD' WHEN P01HSG2='8' THEN '자사상품' WHEN P01HSG2='9' THEN '타사상품' WHEN P01HSG2='A' THEN '자상환불' WHEN P01HSG2='B' THEN '선수현금' WHEN P01HSG2='C' THEN '선수카드' WHEN P01HSG2='D' THEN '선수상품' WHEN P01HSG2='E' THEN '장바구니' WHEN P01HSG2='F' THEN '직불카드' WHEN P01HSG2='G' THEN '사용매출' WHEN P01HSG2='H' THEN 'POINT 결제' WHEN P01HSG2='J' THEN '현대상품' WHEN P01HSG2='K' THEN 'SK상품' WHEN P01HSG2='L' THEN 'LG상품' WHEN P01HSG2='I' THEN '제휴환불' WHEN P01HSG2!='' THEN '기타' ELSE '' END hsG2Nm
        ,P01HSM2 hsM2
        ,P01HSG3 hsG3
        ,CASE WHEN P01HSG3='1' THEN '현금' WHEN P01HSG3='2' THEN '자사카드' WHEN P01HSG3='3' THEN '타사카드' WHEN P01HSG3='4' THEN '외상' WHEN P01HSG3='5' THEN '특판' WHEN P01HSG3='6' THEN '직불' WHEN P01HSG3='7' THEN 'COD' WHEN P01HSG3='8' THEN '자사상품' WHEN P01HSG3='9' THEN '타사상품' WHEN P01HSG3='A' THEN '자상환불' WHEN P01HSG3='B' THEN '선수현금' WHEN P01HSG3='C' THEN '선수카드' WHEN P01HSG3='D' THEN '선수상품' WHEN P01HSG3='E' THEN '장바구니' WHEN P01HSG3='F' THEN '직불카드' WHEN P01HSG3='G' THEN '사용매출' WHEN P01HSG3='H' THEN 'POINT 결제' WHEN P01HSG3='J' THEN '현대상품' WHEN P01HSG3='K' THEN 'SK상품' WHEN P01HSG3='L' THEN 'LG상품' WHEN P01HSG3='I' THEN '제휴환불' WHEN P01HSG3!='' THEN '기타' ELSE '' END hsG3Nm
        ,P01HSM3 hsM3
        ,P01HSG4 hsG4
        ,CASE WHEN P01HSG4='1' THEN '현금' WHEN P01HSG4='2' THEN '자사카드' WHEN P01HSG4='3' THEN '타사카드' WHEN P01HSG4='4' THEN '외상' WHEN P01HSG4='5' THEN '특판' WHEN P01HSG4='6' THEN '직불' WHEN P01HSG4='7' THEN 'COD' WHEN P01HSG4='8' THEN '자사상품' WHEN P01HSG4='9' THEN '타사상품' WHEN P01HSG4='A' THEN '자상환불' WHEN P01HSG4='B' THEN '선수현금' WHEN P01HSG4='C' THEN '선수카드' WHEN P01HSG4='D' THEN '선수상품' WHEN P01HSG4='E' THEN '장바구니' WHEN P01HSG4='F' THEN '직불카드' WHEN P01HSG4='G' THEN '사용매출' WHEN P01HSG4='H' THEN 'POINT 결제' WHEN P01HSG4='J' THEN '현대상품' WHEN P01HSG4='K' THEN 'SK상품' WHEN P01HSG4='L' THEN 'LG상품' WHEN P01HSG4='I' THEN '제휴환불' WHEN P01HSG4!='' THEN '기타' ELSE '' END hsG4Nm
        ,P01HSM4 hsM4
		,P01HSG5 hsG5
        ,CASE WHEN P01HSG5='1' THEN '현금' WHEN P01HSG5='2' THEN '자사카드' WHEN P01HSG5='3' THEN '타사카드' WHEN P01HSG5='4' THEN '외상' WHEN P01HSG5='5' THEN '특판' WHEN P01HSG5='6' THEN '직불' WHEN P01HSG5='7' THEN 'COD' WHEN P01HSG5='8' THEN '자사상품' WHEN P01HSG5='9' THEN '타사상품' WHEN P01HSG5='A' THEN '자상환불' WHEN P01HSG5='B' THEN '선수현금' WHEN P01HSG5='C' THEN '선수카드' WHEN P01HSG5='D' THEN '선수상품' WHEN P01HSG5='E' THEN '장바구니' WHEN P01HSG5='F' THEN '직불카드' WHEN P01HSG5='G' THEN '사용매출' WHEN P01HSG5='H' THEN 'POINT 결제' WHEN P01HSG5='J' THEN '현대상품' WHEN P01HSG5='K' THEN 'SK상품' WHEN P01HSG5='L' THEN 'LG상품' WHEN P01HSG5='I' THEN '제휴환불' WHEN P01HSG5!='' THEN '기타' ELSE '' END hsG5Nm
        ,P01HSM5 hsM5
        ,P01HEGM heGm

FROM ${dbType}SPOTNRDB.SPOPF01
        LEFT OUTER JOIN ${dbType}SPORDB.SPOM18PF
        ON PD1801 = P01HSCD AND PD1802 = P01HRNO
        LEFT OUTER JOIN ${dbType}SPORDB.SPOM11LF2
        ON PD1115 = P01HSCD AND PD1104 = P01HRNO AND PD1107 = '' AND PD1110 ='O'
        LEFT OUTER JOIN ${dbType}SPFRDB.SPFM05PF A
        ON A.MS0501 = P01HSCD AND A.MS0505 = PD1105
WHERE P01HSCD= #{jum}
AND P01HSYY= substr(#{frDate},1,4) 
AND P01HSMM= substr(#{frDate},5,2) 
AND P01HSDD= substr(#{frDate},7,2) 
AND P01HRNO= #{regiNo}
AND P01HTNO &gt;= #{rcptNo1} AND P01HTNO &lt;= #{rcptNo2}



	</select>
	
	
<select id="getRcptNoDanPumInqSearchList"
		parameterType="com.saydept.api.spf.saleNews.rcptNoDanPumInq.model.RcptNoDanPumInqSearchModel"
		resultType="com.saydept.api.spf.saleNews.rcptNoDanPumInq.model.RcptNoDanPumInqSearchModel">

SELECT DISTINCT 
		 P01HRNO regiNo
        ,P01HRNO regiNm
        ,COUNT(*) rcptNo

FROM ${dbType}SPOTNRDB.SPOPF01

WHERE P01HSCD= ${jum}
AND P01HSYY= substr(${frDate},1,4) 
AND P01HSMM= substr(${frDate},5,2) 
AND P01HSDD= substr(${frDate},7,2) 

GROUP BY P01HRNO
ORDER BY regiNo
	</select>

</mapper>


