<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.saydept.api.spf.selng.selngrcpt.trLogConerSaleInq.TrLogConerSaleInqMapper">

	<!--
		mybatis-config.xml text copy
		<typeAlias alias="trLogConerSaleInqModel" type="com.saydept.api.spf.selng.selngrcpt.trLogConerSaleInq.model.TrLogConerSaleInqModel"/>
	-->
	<!-- 단일 조회 -->

<!-- ***************************종료일있을경우************************** -->
<!-- ***************************종료일있을경우************************** -->
<!-- ***************************종료일있을경우************************** -->
	<!-- 목록조회 fetchSize="1000" 옵션은 많은 수의 데이터를 조회 할 때 한번에 읽어들일  크기  -->
	<select id="selectTrLogConerSaleInqList" resultType="com.saydept.api.spf.selng.selngrcpt.trLogConerSaleInq.model.TrLogConerSaleInqModel" 
											parameterType="com.saydept.api.spf.selng.selngrcpt.trLogConerSaleInq.model.TrLogConerSaleInqModel" fetchSize="1000">
		/*selectTrLogConerSaleInqList*/
		
		SELECT 	
		 P01HSYY||'년'||P01HSMM||'월'||P01HSDD||'일' as dt
		,P01HRNO as regi
		,P01HTNO as recipt	
		,
		(
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND (SUBSTR(P01DATA1,74,5)=#{coner} OR SUBSTR(P01DATA1,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA1,38,7))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND (SUBSTR(P01DATA2,74,5)=#{coner} OR SUBSTR(P01DATA2,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA2,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND (SUBSTR(P01DATA3,74,5)=#{coner} OR SUBSTR(P01DATA3,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA3,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND (SUBSTR(P01DATA4,74,5)=#{coner} OR SUBSTR(P01DATA4,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA4,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND (SUBSTR(P01DATA5,74,5)=#{coner} OR SUBSTR(P01DATA5,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA5,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND (SUBSTR(P01DATA6,74,5)=#{coner} OR SUBSTR(P01DATA6,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA6,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND (SUBSTR(P01DATA7,74,5)=#{coner} OR SUBSTR(P01DATA7,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA7,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND (SUBSTR(P01DATA8,74,5)=#{coner} OR SUBSTR(P01DATA8,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA8,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND (SUBSTR(P01DATA9,74,5)=#{coner} OR SUBSTR(P01DATA9,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA9,38,7))	ELSE 0 END 
		)*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END AS discount
		,	
		((
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND (SUBSTR(P01DATA1,74,5)=#{coner} OR SUBSTR(P01DATA1,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA1,24,8))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND (SUBSTR(P01DATA2,74,5)=#{coner} OR SUBSTR(P01DATA2,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA2,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND (SUBSTR(P01DATA3,74,5)=#{coner} OR SUBSTR(P01DATA3,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA3,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND (SUBSTR(P01DATA4,74,5)=#{coner} OR SUBSTR(P01DATA4,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA4,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND (SUBSTR(P01DATA5,74,5)=#{coner} OR SUBSTR(P01DATA5,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA5,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND (SUBSTR(P01DATA6,74,5)=#{coner} OR SUBSTR(P01DATA6,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA6,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND (SUBSTR(P01DATA7,74,5)=#{coner} OR SUBSTR(P01DATA7,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA7,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND (SUBSTR(P01DATA8,74,5)=#{coner} OR SUBSTR(P01DATA8,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA8,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND (SUBSTR(P01DATA9,74,5)=#{coner} OR SUBSTR(P01DATA9,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA9,24,8))	ELSE 0 END 
		)*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END)-	
		((
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND (SUBSTR(P01DATA1,74,5)=#{coner} OR SUBSTR(P01DATA1,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA1,38,7))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND (SUBSTR(P01DATA2,74,5)=#{coner} OR SUBSTR(P01DATA2,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA2,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND (SUBSTR(P01DATA3,74,5)=#{coner} OR SUBSTR(P01DATA3,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA3,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND (SUBSTR(P01DATA4,74,5)=#{coner} OR SUBSTR(P01DATA4,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA4,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND (SUBSTR(P01DATA5,74,5)=#{coner} OR SUBSTR(P01DATA5,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA5,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND (SUBSTR(P01DATA6,74,5)=#{coner} OR SUBSTR(P01DATA6,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA6,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND (SUBSTR(P01DATA7,74,5)=#{coner} OR SUBSTR(P01DATA7,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA7,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND (SUBSTR(P01DATA8,74,5)=#{coner} OR SUBSTR(P01DATA8,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA8,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND (SUBSTR(P01DATA9,74,5)=#{coner} OR SUBSTR(P01DATA9,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA9,38,7))	ELSE 0 END 
		)*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END) AS netSale
		,
		(
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND (SUBSTR(P01DATA1,74,5)=#{coner} OR SUBSTR(P01DATA1,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA1,24,8))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND (SUBSTR(P01DATA2,74,5)=#{coner} OR SUBSTR(P01DATA2,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA2,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND (SUBSTR(P01DATA3,74,5)=#{coner} OR SUBSTR(P01DATA3,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA3,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND (SUBSTR(P01DATA4,74,5)=#{coner} OR SUBSTR(P01DATA4,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA4,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND (SUBSTR(P01DATA5,74,5)=#{coner} OR SUBSTR(P01DATA5,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA5,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND (SUBSTR(P01DATA6,74,5)=#{coner} OR SUBSTR(P01DATA6,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA6,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND (SUBSTR(P01DATA7,74,5)=#{coner} OR SUBSTR(P01DATA7,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA7,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND (SUBSTR(P01DATA8,74,5)=#{coner} OR SUBSTR(P01DATA8,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA8,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND (SUBSTR(P01DATA9,74,5)=#{coner} OR SUBSTR(P01DATA9,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA9,24,8))	ELSE 0 END 
		)*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END AS totSale
		,
		CASE WHEN P01HSGU ='0' THEN '정상'
			  WHEN P01HSGU ='1' THEN '반품'	ELSE ''END AS div
		,MS0505		AS	coner
		,TRIM(MS0510) AS conerNm
FROM ${dbType}SPOTNRDB.SPOPF01
		LEFT OUTER JOIN ${dbType}SPFRDB.SPFM05PF
		ON MS0501=#{jum} and MS0505=#{coner}
WHERE 	P01HSYY||P01HSMM||P01HSDD &gt;=#{startDt} AND P01HSYY||P01HSMM||P01HSDD &lt;=#{endDt} AND
		P01HSCD=#{jum}
		
		AND (
	
		(	SUBSTR(P01DATA1,74,5)=#{coner}
		OR	SUBSTR(P01DATA2,74,5)=#{coner}
		OR	SUBSTR(P01DATA3,74,5)=#{coner}
		OR	SUBSTR(P01DATA4,74,5)=#{coner}
		OR	SUBSTR(P01DATA5,74,5)=#{coner}
		OR	SUBSTR(P01DATA6,74,5)=#{coner}
		OR	SUBSTR(P01DATA7,74,5)=#{coner}
		OR	SUBSTR(P01DATA8,74,5)=#{coner}
		OR	SUBSTR(P01DATA9,74,5)=#{coner}
		)

		OR
		(
			SUBSTR(P01DATA1,17,5)=#{coner}
		OR	SUBSTR(P01DATA2,17,5)=#{coner}
		OR	SUBSTR(P01DATA3,17,5)=#{coner}
		OR	SUBSTR(P01DATA4,17,5)=#{coner}
		OR	SUBSTR(P01DATA5,17,5)=#{coner}
		OR	SUBSTR(P01DATA6,17,5)=#{coner}
		OR	SUBSTR(P01DATA7,17,5)=#{coner}
		OR	SUBSTR(P01DATA8,17,5)=#{coner}
		OR	SUBSTR(P01DATA9,17,5)=#{coner}
		)
		)   
	
			
	ORDER BY P01HSYY,P01HSMM,P01HSDD,P01HRNO

	</select>
	<select id="selectTrLogConerSaleInqList73" resultType="com.saydept.api.spf.selng.selngrcpt.trLogConerSaleInq.model.TrLogConerSaleInqParamModel" 
											parameterType="com.saydept.api.spf.selng.selngrcpt.trLogConerSaleInq.model.TrLogConerSaleInqParamModel" fetchSize="1000">
		SELECT 	P01HSYY||'년'||P01HSMM||'월'||P01HSDD||'일' dt
				,P01HRNO regi
				,P01HTNO recipt
	
		,
		(
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND (SUBSTR(P01DATA1,22,2)='73' OR SUBSTR(P01DATA1,79,2)='73') THEN INT(SUBSTR(P01DATA1,38,7))   ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND (SUBSTR(P01DATA2,22,2)='73' OR SUBSTR(P01DATA2,79,2)='73') THEN INT(SUBSTR(P01DATA2,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND (SUBSTR(P01DATA3,22,2)='73' OR SUBSTR(P01DATA3,79,2)='73') THEN INT(SUBSTR(P01DATA3,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND (SUBSTR(P01DATA4,22,2)='73' OR SUBSTR(P01DATA4,79,2)='73') THEN INT(SUBSTR(P01DATA4,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND (SUBSTR(P01DATA5,22,2)='73' OR SUBSTR(P01DATA5,79,2)='73') THEN INT(SUBSTR(P01DATA5,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND (SUBSTR(P01DATA6,22,2)='73' OR SUBSTR(P01DATA6,79,2)='73') THEN INT(SUBSTR(P01DATA6,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND (SUBSTR(P01DATA7,22,2)='73' OR SUBSTR(P01DATA7,79,2)='73') THEN INT(SUBSTR(P01DATA7,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND (SUBSTR(P01DATA8,22,2)='73' OR SUBSTR(P01DATA8,79,2)='73') THEN INT(SUBSTR(P01DATA8,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND (SUBSTR(P01DATA9,22,2)='73' OR SUBSTR(P01DATA9,79,2)='73') THEN INT(SUBSTR(P01DATA9,38,7))	ELSE 0 END )*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END AS discount
			
		
		,
		((
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND (SUBSTR(P01DATA1,22,2)='73' OR SUBSTR(P01DATA1,79,2)='73')  THEN INT(SUBSTR(P01DATA1,24,8))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND (SUBSTR(P01DATA2,22,2)='73' OR SUBSTR(P01DATA2,79,2)='73')  THEN INT(SUBSTR(P01DATA2,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND (SUBSTR(P01DATA3,22,2)='73' OR SUBSTR(P01DATA3,79,2)='73')  THEN INT(SUBSTR(P01DATA3,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND (SUBSTR(P01DATA4,22,2)='73' OR SUBSTR(P01DATA4,79,2)='73')  THEN INT(SUBSTR(P01DATA4,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND (SUBSTR(P01DATA5,22,2)='73' OR SUBSTR(P01DATA5,79,2)='73') THEN INT(SUBSTR(P01DATA5,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND (SUBSTR(P01DATA6,22,2)='73' OR SUBSTR(P01DATA6,79,2)='73') THEN INT(SUBSTR(P01DATA6,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND (SUBSTR(P01DATA7,22,2)='73' OR SUBSTR(P01DATA7,79,2)='73') THEN INT(SUBSTR(P01DATA7,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND (SUBSTR(P01DATA8,22,2)='73' OR SUBSTR(P01DATA8,79,2)='73') THEN INT(SUBSTR(P01DATA8,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND (SUBSTR(P01DATA9,22,2)='73' OR SUBSTR(P01DATA9,79,2)='73') THEN INT(SUBSTR(P01DATA9,24,8))	ELSE 0 END )*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END)-	
		((
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND (SUBSTR(P01DATA1,22,2)='73' OR SUBSTR(P01DATA1,79,2)='73')  THEN INT(SUBSTR(P01DATA1,38,7))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND (SUBSTR(P01DATA2,22,2)='73' OR SUBSTR(P01DATA2,79,2)='73') THEN INT(SUBSTR(P01DATA2,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND (SUBSTR(P01DATA3,22,2)='73' OR SUBSTR(P01DATA3,79,2)='73')  THEN INT(SUBSTR(P01DATA3,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND (SUBSTR(P01DATA4,22,2)='73' OR SUBSTR(P01DATA4,79,2)='73') THEN INT(SUBSTR(P01DATA4,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND (SUBSTR(P01DATA5,22,2)='73' OR SUBSTR(P01DATA5,79,2)='73') THEN INT(SUBSTR(P01DATA5,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND (SUBSTR(P01DATA6,22,2)='73' OR SUBSTR(P01DATA6,79,2)='73')  THEN INT(SUBSTR(P01DATA6,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND (SUBSTR(P01DATA7,22,2)='73' OR SUBSTR(P01DATA7,79,2)='73')  THEN INT(SUBSTR(P01DATA7,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND (SUBSTR(P01DATA8,22,2)='73' OR SUBSTR(P01DATA8,79,2)='73')  THEN INT(SUBSTR(P01DATA8,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND (SUBSTR(P01DATA9,22,2)='73' OR SUBSTR(P01DATA9,79,2)='73')  THEN INT(SUBSTR(P01DATA9,38,7))	ELSE 0 END )*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END) AS netSale
		,

		(
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND (SUBSTR(P01DATA1,22,2)='73' OR SUBSTR(P01DATA1,79,2)='73') THEN INT(SUBSTR(P01DATA1,24,8))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND (SUBSTR(P01DATA2,22,2)='73' OR SUBSTR(P01DATA2,79,2)='73') THEN INT(SUBSTR(P01DATA2,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND (SUBSTR(P01DATA3,22,2)='73' OR SUBSTR(P01DATA3,79,2)='73') THEN INT(SUBSTR(P01DATA3,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND (SUBSTR(P01DATA4,22,2)='73' OR SUBSTR(P01DATA4,79,2)='73') THEN INT(SUBSTR(P01DATA4,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND (SUBSTR(P01DATA5,22,2)='73' OR SUBSTR(P01DATA5,79,2)='73') THEN INT(SUBSTR(P01DATA5,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND (SUBSTR(P01DATA6,22,2)='73' OR SUBSTR(P01DATA6,79,2)='73') THEN INT(SUBSTR(P01DATA6,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND (SUBSTR(P01DATA7,22,2)='73' OR SUBSTR(P01DATA7,79,2)='73') THEN INT(SUBSTR(P01DATA7,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND (SUBSTR(P01DATA8,22,2)='73' OR SUBSTR(P01DATA8,79,2)='73') THEN INT(SUBSTR(P01DATA8,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND (SUBSTR(P01DATA9,22,2)='73' OR SUBSTR(P01DATA9,79,2)='73') THEN INT(SUBSTR(P01DATA9,24,8))	ELSE 0 END )*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END AS totSale
		,
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND SUBSTR(P01DATA1,79,2)='73' THEN SUBSTR(P01DATA1,74,5)  	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND SUBSTR(P01DATA2,79,2)='73' THEN SUBSTR(P01DATA2,74,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND SUBSTR(P01DATA3,79,2)='73' THEN SUBSTR(P01DATA3,74,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND SUBSTR(P01DATA4,79,2)='73' THEN SUBSTR(P01DATA4,74,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND SUBSTR(P01DATA5,79,2)='73' THEN SUBSTR(P01DATA5,74,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND SUBSTR(P01DATA6,79,2)='73' THEN SUBSTR(P01DATA6,74,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND SUBSTR(P01DATA7,79,2)='73' THEN SUBSTR(P01DATA7,74,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND SUBSTR(P01DATA8,79,2)='73' THEN SUBSTR(P01DATA8,74,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND SUBSTR(P01DATA9,79,2)='73' THEN SUBSTR(P01DATA9,74,5)	ELSE '' END ||''||
		
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND SUBSTR(P01DATA1,22,2)='73' THEN SUBSTR(P01DATA1,17,5)  	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND SUBSTR(P01DATA2,22,2)='73' THEN SUBSTR(P01DATA2,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND SUBSTR(P01DATA3,22,2)='73' THEN SUBSTR(P01DATA3,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND SUBSTR(P01DATA4,22,2)='73' THEN SUBSTR(P01DATA4,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND SUBSTR(P01DATA5,22,2)='73' THEN SUBSTR(P01DATA5,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND SUBSTR(P01DATA6,22,2)='73' THEN SUBSTR(P01DATA6,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND SUBSTR(P01DATA7,22,2)='73' THEN SUBSTR(P01DATA7,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND SUBSTR(P01DATA8,22,2)='73' THEN SUBSTR(P01DATA8,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND SUBSTR(P01DATA9,22,2)='73' THEN SUBSTR(P01DATA9,17,5)	ELSE '' END  as coner
		,
		
		CASE WHEN P01HSGU ='0' THEN '정상'
			  WHEN P01HSGU ='1' THEN '반품'	ELSE ''END AS div
			  
		,TRIM(MS0510)	AS conerNm
	FROM ${dbType}SPOTNRDB.SPOPF01
		LEFT OUTER JOIN SPFRDB.SPFM05PF 
		ON MS0501='01' AND MS0505=					SUBSTR( CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND SUBSTR(P01DATA1,79,2)='73' THEN SUBSTR(P01DATA1,74,5)  	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND SUBSTR(P01DATA2,79,2)='73' THEN SUBSTR(P01DATA2,74,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND SUBSTR(P01DATA3,79,2)='73' THEN SUBSTR(P01DATA3,74,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND SUBSTR(P01DATA4,79,2)='73' THEN SUBSTR(P01DATA4,74,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND SUBSTR(P01DATA5,79,2)='73' THEN SUBSTR(P01DATA5,74,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND SUBSTR(P01DATA6,79,2)='73' THEN SUBSTR(P01DATA6,74,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND SUBSTR(P01DATA7,79,2)='73' THEN SUBSTR(P01DATA7,74,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND SUBSTR(P01DATA8,79,2)='73' THEN SUBSTR(P01DATA8,74,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND SUBSTR(P01DATA9,79,2)='73' THEN SUBSTR(P01DATA9,74,5)	ELSE '' END ||''||
															
															CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND SUBSTR(P01DATA1,22,2)='73' THEN SUBSTR(P01DATA1,17,5)  	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND SUBSTR(P01DATA2,22,2)='73' THEN SUBSTR(P01DATA2,17,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND SUBSTR(P01DATA3,22,2)='73' THEN SUBSTR(P01DATA3,17,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND SUBSTR(P01DATA4,22,2)='73' THEN SUBSTR(P01DATA4,17,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND SUBSTR(P01DATA5,22,2)='73' THEN SUBSTR(P01DATA5,17,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND SUBSTR(P01DATA6,22,2)='73' THEN SUBSTR(P01DATA6,17,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND SUBSTR(P01DATA7,22,2)='73' THEN SUBSTR(P01DATA7,17,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND SUBSTR(P01DATA8,22,2)='73' THEN SUBSTR(P01DATA8,17,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND SUBSTR(P01DATA9,22,2)='73' THEN SUBSTR(P01DATA9,17,5)	ELSE '' END,1,5)

	 	WHERE P01HSYY||P01HSMM||P01HSDD &gt;=#{startDt} AND P01HSYY||P01HSMM||P01HSDD &lt;=#{endDt} AND 
		 P01HSCD=#{jum} AND 
			--AND P01HRNO='7281'   --포스번호

	 
			(	
				(SUBSTR(P01DATA1,1,1)='1' AND SUBSTR(P01DATA1,22,2)='73')
			OR	(SUBSTR(P01DATA2,1,1)='1' AND SUBSTR(P01DATA2,22,2)='73')
			OR	(SUBSTR(P01DATA3,1,1)='1' AND SUBSTR(P01DATA3,22,2)='73')
			OR	(SUBSTR(P01DATA4,1,1)='1' AND SUBSTR(P01DATA4,22,2)='73')
			OR	(SUBSTR(P01DATA5,1,1)='1' AND SUBSTR(P01DATA5,22,2)='73')
			OR	(SUBSTR(P01DATA6,1,1)='1' AND SUBSTR(P01DATA6,22,2)='73')
			OR	(SUBSTR(P01DATA7,1,1)='1' AND SUBSTR(P01DATA7,22,2)='73')
			OR	(SUBSTR(P01DATA8,1,1)='1' AND SUBSTR(P01DATA8,22,2)='73')
			OR	(SUBSTR(P01DATA9,1,1)='1' AND SUBSTR(P01DATA9,22,2)='73')
			OR	(SUBSTR(P01DATA1,1,1)='1' AND SUBSTR(P01DATA1,79,2)='73')
			OR	(SUBSTR(P01DATA2,1,1)='1' AND SUBSTR(P01DATA2,79,2)='73')
			OR	(SUBSTR(P01DATA3,1,1)='1' AND SUBSTR(P01DATA3,79,2)='73')
			OR	(SUBSTR(P01DATA4,1,1)='1' AND SUBSTR(P01DATA4,79,2)='73')
			OR	(SUBSTR(P01DATA5,1,1)='1' AND SUBSTR(P01DATA5,79,2)='73')
			OR	(SUBSTR(P01DATA6,1,1)='1' AND SUBSTR(P01DATA6,79,2)='73')
			OR	(SUBSTR(P01DATA7,1,1)='1' AND SUBSTR(P01DATA7,79,2)='73')
			OR	(SUBSTR(P01DATA8,1,1)='1' AND SUBSTR(P01DATA8,79,2)='73')
			OR	(SUBSTR(P01DATA9,1,1)='1' AND SUBSTR(P01DATA9,79,2)='73')
			)
			--코너검색
			<if test="coner !=''">
			AND
			(
				(	SUBSTR(P01DATA1,74,5)=#{coner}
				OR	SUBSTR(P01DATA2,74,5)=#{coner}
				OR	SUBSTR(P01DATA3,74,5)=#{coner}
				OR	SUBSTR(P01DATA4,74,5)=#{coner}
				OR	SUBSTR(P01DATA5,74,5)=#{coner}
				OR	SUBSTR(P01DATA6,74,5)=#{coner}
				OR	SUBSTR(P01DATA7,74,5)=#{coner}
				OR	SUBSTR(P01DATA8,74,5)=#{coner}
				OR	SUBSTR(P01DATA9,74,5)=#{coner}
				)
	
			OR
				(	SUBSTR(P01DATA1,17,5)=#{coner}
				OR	SUBSTR(P01DATA2,17,5)=#{coner}
				OR	SUBSTR(P01DATA3,17,5)=#{coner}
				OR	SUBSTR(P01DATA4,17,5)=#{coner}
				OR	SUBSTR(P01DATA5,17,5)=#{coner}
				OR	SUBSTR(P01DATA6,17,5)=#{coner}
				OR	SUBSTR(P01DATA7,17,5)=#{coner}
				OR	SUBSTR(P01DATA8,17,5)=#{coner}
				OR	SUBSTR(P01DATA9,17,5)=#{coner}
				)
			)   
			</if>
	ORDER BY P01HSYY,P01HSMM,P01HSDD,P01HRNO
		
	</select>
	<select id="noEndDtselectTrLogConerSaleInqListCredit" resultType="com.saydept.api.spf.selng.selngrcpt.trLogConerSaleInq.model.TrLogConerSaleInqModel" 
											parameterType="com.saydept.api.spf.selng.selngrcpt.trLogConerSaleInq.model.TrLogConerSaleInqParamModel" fetchSize="1000">
	
	
	SELECT 	P01HSYY||'년'||P01HSMM||'월'||P01HSDD||'일' dt,P01HRNO Regi,P01HTNO Recipt
	
		,
		(
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' THEN INT(SUBSTR(P01DATA1,38,7))   ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' THEN INT(SUBSTR(P01DATA2,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' THEN INT(SUBSTR(P01DATA3,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' THEN INT(SUBSTR(P01DATA4,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' THEN INT(SUBSTR(P01DATA5,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' THEN INT(SUBSTR(P01DATA6,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' THEN INT(SUBSTR(P01DATA7,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' THEN INT(SUBSTR(P01DATA8,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' THEN INT(SUBSTR(P01DATA9,38,7))	ELSE 0 END )*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END AS discount
			
		
		,
		((
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' THEN INT(SUBSTR(P01DATA1,24,8))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' THEN INT(SUBSTR(P01DATA2,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' THEN INT(SUBSTR(P01DATA3,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' THEN INT(SUBSTR(P01DATA4,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' THEN INT(SUBSTR(P01DATA5,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' THEN INT(SUBSTR(P01DATA6,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' THEN INT(SUBSTR(P01DATA7,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' THEN INT(SUBSTR(P01DATA8,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' THEN INT(SUBSTR(P01DATA9,24,8))	ELSE 0 END )*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END)-	
		((
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' THEN INT(SUBSTR(P01DATA1,38,7))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' THEN INT(SUBSTR(P01DATA2,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' THEN INT(SUBSTR(P01DATA3,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' THEN INT(SUBSTR(P01DATA4,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' THEN INT(SUBSTR(P01DATA5,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' THEN INT(SUBSTR(P01DATA6,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' THEN INT(SUBSTR(P01DATA7,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' THEN INT(SUBSTR(P01DATA8,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' THEN INT(SUBSTR(P01DATA9,38,7))	ELSE 0 END )*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END) AS netSale
		,

		(
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' THEN INT(SUBSTR(P01DATA1,24,8))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' THEN INT(SUBSTR(P01DATA2,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' THEN INT(SUBSTR(P01DATA3,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' THEN INT(SUBSTR(P01DATA4,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' THEN INT(SUBSTR(P01DATA5,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' THEN INT(SUBSTR(P01DATA6,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' THEN INT(SUBSTR(P01DATA7,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' THEN INT(SUBSTR(P01DATA8,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' THEN INT(SUBSTR(P01DATA9,24,8))	ELSE 0 END )*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END AS totSale
		,
	
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' THEN SUBSTR(P01DATA1,17,5)  	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' THEN SUBSTR(P01DATA2,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' THEN SUBSTR(P01DATA3,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' THEN SUBSTR(P01DATA4,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' THEN SUBSTR(P01DATA5,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' THEN SUBSTR(P01DATA6,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' THEN SUBSTR(P01DATA7,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' THEN SUBSTR(P01DATA8,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' THEN SUBSTR(P01DATA9,17,5)	ELSE '' END  
		,
		CASE WHEN P01HSGU ='0' THEN '정상'
			  WHEN P01HSGU ='1' THEN '반품'	ELSE ''END AS div
		,TRIM(MS0510) AS conerNm
		
		FROM SPOTNRDB.SPOPF01
			LEFT OUTER JOIN SPFRDB.SPFM05PF 
		ON MS0501='01' AND MS0505=	SUBSTR(	CASE WHEN SUBSTR(P01DATA1,1,1)='1' THEN SUBSTR(P01DATA1,17,5)  	ELSE '' END ||''||
											CASE WHEN SUBSTR(P01DATA2,1,1)='1' THEN SUBSTR(P01DATA2,17,5)	ELSE '' END ||''||
											CASE WHEN SUBSTR(P01DATA3,1,1)='1' THEN SUBSTR(P01DATA3,17,5)	ELSE '' END ||''||
											CASE WHEN SUBSTR(P01DATA4,1,1)='1' THEN SUBSTR(P01DATA4,17,5)	ELSE '' END ||''||
											CASE WHEN SUBSTR(P01DATA5,1,1)='1' THEN SUBSTR(P01DATA5,17,5)	ELSE '' END ||''||
											CASE WHEN SUBSTR(P01DATA6,1,1)='1' THEN SUBSTR(P01DATA6,17,5)	ELSE '' END ||''||
											CASE WHEN SUBSTR(P01DATA7,1,1)='1' THEN SUBSTR(P01DATA7,17,5)	ELSE '' END ||''||
											CASE WHEN SUBSTR(P01DATA8,1,1)='1' THEN SUBSTR(P01DATA8,17,5)	ELSE '' END ||''||
											CASE WHEN SUBSTR(P01DATA9,1,1)='1' THEN SUBSTR(P01DATA9,17,5)	ELSE '' END,1,5)
											
		 WHERE  P01HSCD=#{jum} AND P01HSYY||P01HSMM||P01HSDD &gt;=#{startDt} AND P01HSYY||P01HSMM||P01HSDD &lt;=#{endDt} AND 
		 		(P01HSG1='4' OR P01HSG2='4' or P01HSG3='4' or P01HSG4='4' or P01HSG5='4')
	
	
			<if test="coner !=''">
					AND
					(
						(	SUBSTR(P01DATA1,74,5)=#{coner}
						OR	SUBSTR(P01DATA2,74,5)=#{coner}
						OR	SUBSTR(P01DATA3,74,5)=#{coner}
						OR	SUBSTR(P01DATA4,74,5)=#{coner}
						OR	SUBSTR(P01DATA5,74,5)=#{coner}
						OR	SUBSTR(P01DATA6,74,5)=#{coner}
						OR	SUBSTR(P01DATA7,74,5)=#{coner}
						OR	SUBSTR(P01DATA8,74,5)=#{coner}
						OR	SUBSTR(P01DATA9,74,5)=#{coner}
						)
			
					OR
						(	SUBSTR(P01DATA1,17,5)=#{coner}
						OR	SUBSTR(P01DATA2,17,5)=#{coner}
						OR	SUBSTR(P01DATA3,17,5)=#{coner}
						OR	SUBSTR(P01DATA4,17,5)=#{coner}
						OR	SUBSTR(P01DATA5,17,5)=#{coner}
						OR	SUBSTR(P01DATA6,17,5)=#{coner}
						OR	SUBSTR(P01DATA7,17,5)=#{coner}
						OR	SUBSTR(P01DATA8,17,5)=#{coner}
						OR	SUBSTR(P01DATA9,17,5)=#{coner}
						)
					)   
			</if>
		ORDER BY P01HSYY,P01HSMM,P01HSDD,P01HRNO
	</select>
	
<!-- ***************************종료일없을경우************************** -->
<!-- ***************************종료일없을경우************************** -->
<!-- ***************************종료일없을경우************************** -->
	<select id="noEndDtselectTrLogConerSaleInqList" resultType="com.saydept.api.spf.selng.selngrcpt.trLogConerSaleInq.model.TrLogConerSaleInqModel" 
											parameterType="com.saydept.api.spf.selng.selngrcpt.trLogConerSaleInq.model.TrLogConerSaleInqModel" fetchSize="1000">
		/*selectTrLogConerSaleInqList*/
		
		SELECT 	
		 P01HSYY||'년'||P01HSMM||'월'||P01HSDD||'일' as dt
		,P01HRNO as regi
		,P01HTNO as recipt	
		,
		(
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND (SUBSTR(P01DATA1,74,5)=#{coner} OR SUBSTR(P01DATA1,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA1,38,7))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND (SUBSTR(P01DATA2,74,5)=#{coner} OR SUBSTR(P01DATA2,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA2,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND (SUBSTR(P01DATA3,74,5)=#{coner} OR SUBSTR(P01DATA3,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA3,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND (SUBSTR(P01DATA4,74,5)=#{coner} OR SUBSTR(P01DATA4,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA4,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND (SUBSTR(P01DATA5,74,5)=#{coner} OR SUBSTR(P01DATA5,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA5,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND (SUBSTR(P01DATA6,74,5)=#{coner} OR SUBSTR(P01DATA6,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA6,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND (SUBSTR(P01DATA7,74,5)=#{coner} OR SUBSTR(P01DATA7,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA7,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND (SUBSTR(P01DATA8,74,5)=#{coner} OR SUBSTR(P01DATA8,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA8,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND (SUBSTR(P01DATA9,74,5)=#{coner} OR SUBSTR(P01DATA9,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA9,38,7))	ELSE 0 END 
		)*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END AS discount
		,	
		((
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND (SUBSTR(P01DATA1,74,5)=#{coner} OR SUBSTR(P01DATA1,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA1,24,8))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND (SUBSTR(P01DATA2,74,5)=#{coner} OR SUBSTR(P01DATA2,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA2,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND (SUBSTR(P01DATA3,74,5)=#{coner} OR SUBSTR(P01DATA3,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA3,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND (SUBSTR(P01DATA4,74,5)=#{coner} OR SUBSTR(P01DATA4,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA4,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND (SUBSTR(P01DATA5,74,5)=#{coner} OR SUBSTR(P01DATA5,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA5,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND (SUBSTR(P01DATA6,74,5)=#{coner} OR SUBSTR(P01DATA6,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA6,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND (SUBSTR(P01DATA7,74,5)=#{coner} OR SUBSTR(P01DATA7,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA7,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND (SUBSTR(P01DATA8,74,5)=#{coner} OR SUBSTR(P01DATA8,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA8,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND (SUBSTR(P01DATA9,74,5)=#{coner} OR SUBSTR(P01DATA9,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA9,24,8))	ELSE 0 END 
		)*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END)-	
		((
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND (SUBSTR(P01DATA1,74,5)=#{coner} OR SUBSTR(P01DATA1,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA1,38,7))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND (SUBSTR(P01DATA2,74,5)=#{coner} OR SUBSTR(P01DATA2,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA2,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND (SUBSTR(P01DATA3,74,5)=#{coner} OR SUBSTR(P01DATA3,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA3,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND (SUBSTR(P01DATA4,74,5)=#{coner} OR SUBSTR(P01DATA4,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA4,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND (SUBSTR(P01DATA5,74,5)=#{coner} OR SUBSTR(P01DATA5,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA5,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND (SUBSTR(P01DATA6,74,5)=#{coner} OR SUBSTR(P01DATA6,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA6,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND (SUBSTR(P01DATA7,74,5)=#{coner} OR SUBSTR(P01DATA7,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA7,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND (SUBSTR(P01DATA8,74,5)=#{coner} OR SUBSTR(P01DATA8,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA8,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND (SUBSTR(P01DATA9,74,5)=#{coner} OR SUBSTR(P01DATA9,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA9,38,7))	ELSE 0 END 
		)*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END) AS netSale
		,
		(
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND (SUBSTR(P01DATA1,74,5)=#{coner} OR SUBSTR(P01DATA1,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA1,24,8))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND (SUBSTR(P01DATA2,74,5)=#{coner} OR SUBSTR(P01DATA2,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA2,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND (SUBSTR(P01DATA3,74,5)=#{coner} OR SUBSTR(P01DATA3,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA3,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND (SUBSTR(P01DATA4,74,5)=#{coner} OR SUBSTR(P01DATA4,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA4,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND (SUBSTR(P01DATA5,74,5)=#{coner} OR SUBSTR(P01DATA5,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA5,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND (SUBSTR(P01DATA6,74,5)=#{coner} OR SUBSTR(P01DATA6,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA6,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND (SUBSTR(P01DATA7,74,5)=#{coner} OR SUBSTR(P01DATA7,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA7,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND (SUBSTR(P01DATA8,74,5)=#{coner} OR SUBSTR(P01DATA8,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA8,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND (SUBSTR(P01DATA9,74,5)=#{coner} OR SUBSTR(P01DATA9,17,5)=#{coner}) THEN INT(SUBSTR(P01DATA9,24,8))	ELSE 0 END 
		)*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END AS totSale
		,
		CASE WHEN P01HSGU ='0' THEN '정상'
			  WHEN P01HSGU ='1' THEN '반품'	ELSE ''END AS div
		,MS0505		AS	coner
		,TRIM(MS0510) AS conerNm
FROM ${dbType}SPOTNRDB.SPOPF01
		LEFT OUTER JOIN ${dbType}SPFRDB.SPFM05PF
		ON MS0501=#{jum} and MS0505=#{coner}
WHERE 	P01HSYY=substr(#{startDt},1,4) and P01HSMM=substr(#{startDt},5,2) and P01HSDD =substr(#{startDt},7,2) AND
		P01HSCD=#{jum}
		
		AND (
	
		(	SUBSTR(P01DATA1,74,5)=#{coner}
		OR	SUBSTR(P01DATA2,74,5)=#{coner}
		OR	SUBSTR(P01DATA3,74,5)=#{coner}
		OR	SUBSTR(P01DATA4,74,5)=#{coner}
		OR	SUBSTR(P01DATA5,74,5)=#{coner}
		OR	SUBSTR(P01DATA6,74,5)=#{coner}
		OR	SUBSTR(P01DATA7,74,5)=#{coner}
		OR	SUBSTR(P01DATA8,74,5)=#{coner}
		OR	SUBSTR(P01DATA9,74,5)=#{coner}
		)

		OR
		(
			SUBSTR(P01DATA1,17,5)=#{coner}
		OR	SUBSTR(P01DATA2,17,5)=#{coner}
		OR	SUBSTR(P01DATA3,17,5)=#{coner}
		OR	SUBSTR(P01DATA4,17,5)=#{coner}
		OR	SUBSTR(P01DATA5,17,5)=#{coner}
		OR	SUBSTR(P01DATA6,17,5)=#{coner}
		OR	SUBSTR(P01DATA7,17,5)=#{coner}
		OR	SUBSTR(P01DATA8,17,5)=#{coner}
		OR	SUBSTR(P01DATA9,17,5)=#{coner}
		)
		)   
	
			
	ORDER BY P01HSYY,P01HSMM,P01HSDD,P01HRNO

	</select>
	<select id="noEndDtselectTrLogConerSaleInqList73" resultType="com.saydept.api.spf.selng.selngrcpt.trLogConerSaleInq.model.TrLogConerSaleInqParamModel" 
											parameterType="com.saydept.api.spf.selng.selngrcpt.trLogConerSaleInq.model.TrLogConerSaleInqParamModel" fetchSize="1000">
		SELECT 	P01HSYY||'년'||P01HSMM||'월'||P01HSDD||'일' dt
				,P01HRNO regi
				,P01HTNO recipt
	
		,
		(
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND (SUBSTR(P01DATA1,22,2)='73' OR SUBSTR(P01DATA1,79,2)='73') THEN INT(SUBSTR(P01DATA1,38,7))   ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND (SUBSTR(P01DATA2,22,2)='73' OR SUBSTR(P01DATA2,79,2)='73') THEN INT(SUBSTR(P01DATA2,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND (SUBSTR(P01DATA3,22,2)='73' OR SUBSTR(P01DATA3,79,2)='73') THEN INT(SUBSTR(P01DATA3,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND (SUBSTR(P01DATA4,22,2)='73' OR SUBSTR(P01DATA4,79,2)='73') THEN INT(SUBSTR(P01DATA4,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND (SUBSTR(P01DATA5,22,2)='73' OR SUBSTR(P01DATA5,79,2)='73') THEN INT(SUBSTR(P01DATA5,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND (SUBSTR(P01DATA6,22,2)='73' OR SUBSTR(P01DATA6,79,2)='73') THEN INT(SUBSTR(P01DATA6,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND (SUBSTR(P01DATA7,22,2)='73' OR SUBSTR(P01DATA7,79,2)='73') THEN INT(SUBSTR(P01DATA7,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND (SUBSTR(P01DATA8,22,2)='73' OR SUBSTR(P01DATA8,79,2)='73') THEN INT(SUBSTR(P01DATA8,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND (SUBSTR(P01DATA9,22,2)='73' OR SUBSTR(P01DATA9,79,2)='73') THEN INT(SUBSTR(P01DATA9,38,7))	ELSE 0 END )*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END AS discount
			
		
		,
		((
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND (SUBSTR(P01DATA1,22,2)='73' OR SUBSTR(P01DATA1,79,2)='73')  THEN INT(SUBSTR(P01DATA1,24,8))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND (SUBSTR(P01DATA2,22,2)='73' OR SUBSTR(P01DATA2,79,2)='73')  THEN INT(SUBSTR(P01DATA2,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND (SUBSTR(P01DATA3,22,2)='73' OR SUBSTR(P01DATA3,79,2)='73')  THEN INT(SUBSTR(P01DATA3,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND (SUBSTR(P01DATA4,22,2)='73' OR SUBSTR(P01DATA4,79,2)='73')  THEN INT(SUBSTR(P01DATA4,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND (SUBSTR(P01DATA5,22,2)='73' OR SUBSTR(P01DATA5,79,2)='73') THEN INT(SUBSTR(P01DATA5,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND (SUBSTR(P01DATA6,22,2)='73' OR SUBSTR(P01DATA6,79,2)='73') THEN INT(SUBSTR(P01DATA6,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND (SUBSTR(P01DATA7,22,2)='73' OR SUBSTR(P01DATA7,79,2)='73') THEN INT(SUBSTR(P01DATA7,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND (SUBSTR(P01DATA8,22,2)='73' OR SUBSTR(P01DATA8,79,2)='73') THEN INT(SUBSTR(P01DATA8,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND (SUBSTR(P01DATA9,22,2)='73' OR SUBSTR(P01DATA9,79,2)='73') THEN INT(SUBSTR(P01DATA9,24,8))	ELSE 0 END )*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END)-	
		((
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND (SUBSTR(P01DATA1,22,2)='73' OR SUBSTR(P01DATA1,79,2)='73')  THEN INT(SUBSTR(P01DATA1,38,7))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND (SUBSTR(P01DATA2,22,2)='73' OR SUBSTR(P01DATA2,79,2)='73') THEN INT(SUBSTR(P01DATA2,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND (SUBSTR(P01DATA3,22,2)='73' OR SUBSTR(P01DATA3,79,2)='73')  THEN INT(SUBSTR(P01DATA3,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND (SUBSTR(P01DATA4,22,2)='73' OR SUBSTR(P01DATA4,79,2)='73') THEN INT(SUBSTR(P01DATA4,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND (SUBSTR(P01DATA5,22,2)='73' OR SUBSTR(P01DATA5,79,2)='73') THEN INT(SUBSTR(P01DATA5,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND (SUBSTR(P01DATA6,22,2)='73' OR SUBSTR(P01DATA6,79,2)='73')  THEN INT(SUBSTR(P01DATA6,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND (SUBSTR(P01DATA7,22,2)='73' OR SUBSTR(P01DATA7,79,2)='73')  THEN INT(SUBSTR(P01DATA7,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND (SUBSTR(P01DATA8,22,2)='73' OR SUBSTR(P01DATA8,79,2)='73')  THEN INT(SUBSTR(P01DATA8,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND (SUBSTR(P01DATA9,22,2)='73' OR SUBSTR(P01DATA9,79,2)='73')  THEN INT(SUBSTR(P01DATA9,38,7))	ELSE 0 END )*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END) AS netSale
		,

		(
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND (SUBSTR(P01DATA1,22,2)='73' OR SUBSTR(P01DATA1,79,2)='73') THEN INT(SUBSTR(P01DATA1,24,8))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND (SUBSTR(P01DATA2,22,2)='73' OR SUBSTR(P01DATA2,79,2)='73') THEN INT(SUBSTR(P01DATA2,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND (SUBSTR(P01DATA3,22,2)='73' OR SUBSTR(P01DATA3,79,2)='73') THEN INT(SUBSTR(P01DATA3,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND (SUBSTR(P01DATA4,22,2)='73' OR SUBSTR(P01DATA4,79,2)='73') THEN INT(SUBSTR(P01DATA4,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND (SUBSTR(P01DATA5,22,2)='73' OR SUBSTR(P01DATA5,79,2)='73') THEN INT(SUBSTR(P01DATA5,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND (SUBSTR(P01DATA6,22,2)='73' OR SUBSTR(P01DATA6,79,2)='73') THEN INT(SUBSTR(P01DATA6,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND (SUBSTR(P01DATA7,22,2)='73' OR SUBSTR(P01DATA7,79,2)='73') THEN INT(SUBSTR(P01DATA7,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND (SUBSTR(P01DATA8,22,2)='73' OR SUBSTR(P01DATA8,79,2)='73') THEN INT(SUBSTR(P01DATA8,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND (SUBSTR(P01DATA9,22,2)='73' OR SUBSTR(P01DATA9,79,2)='73') THEN INT(SUBSTR(P01DATA9,24,8))	ELSE 0 END )*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END AS totSale
		,
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND SUBSTR(P01DATA1,79,2)='73' THEN SUBSTR(P01DATA1,74,5)  	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND SUBSTR(P01DATA2,79,2)='73' THEN SUBSTR(P01DATA2,74,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND SUBSTR(P01DATA3,79,2)='73' THEN SUBSTR(P01DATA3,74,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND SUBSTR(P01DATA4,79,2)='73' THEN SUBSTR(P01DATA4,74,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND SUBSTR(P01DATA5,79,2)='73' THEN SUBSTR(P01DATA5,74,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND SUBSTR(P01DATA6,79,2)='73' THEN SUBSTR(P01DATA6,74,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND SUBSTR(P01DATA7,79,2)='73' THEN SUBSTR(P01DATA7,74,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND SUBSTR(P01DATA8,79,2)='73' THEN SUBSTR(P01DATA8,74,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND SUBSTR(P01DATA9,79,2)='73' THEN SUBSTR(P01DATA9,74,5)	ELSE '' END ||''||
		
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND SUBSTR(P01DATA1,22,2)='73' THEN SUBSTR(P01DATA1,17,5)  	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND SUBSTR(P01DATA2,22,2)='73' THEN SUBSTR(P01DATA2,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND SUBSTR(P01DATA3,22,2)='73' THEN SUBSTR(P01DATA3,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND SUBSTR(P01DATA4,22,2)='73' THEN SUBSTR(P01DATA4,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND SUBSTR(P01DATA5,22,2)='73' THEN SUBSTR(P01DATA5,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND SUBSTR(P01DATA6,22,2)='73' THEN SUBSTR(P01DATA6,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND SUBSTR(P01DATA7,22,2)='73' THEN SUBSTR(P01DATA7,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND SUBSTR(P01DATA8,22,2)='73' THEN SUBSTR(P01DATA8,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND SUBSTR(P01DATA9,22,2)='73' THEN SUBSTR(P01DATA9,17,5)	ELSE '' END  as coner
		,
		
		CASE WHEN P01HSGU ='0' THEN '정상'
			  WHEN P01HSGU ='1' THEN '반품'	ELSE ''END AS div
			  
		,TRIM(MS0510)	AS conerNm
	FROM ${dbType}SPOTNRDB.SPOPF01
		LEFT OUTER JOIN SPFRDB.SPFM05PF 
		ON MS0501='01' AND MS0505=					SUBSTR( CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND SUBSTR(P01DATA1,79,2)='73' THEN SUBSTR(P01DATA1,74,5)  	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND SUBSTR(P01DATA2,79,2)='73' THEN SUBSTR(P01DATA2,74,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND SUBSTR(P01DATA3,79,2)='73' THEN SUBSTR(P01DATA3,74,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND SUBSTR(P01DATA4,79,2)='73' THEN SUBSTR(P01DATA4,74,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND SUBSTR(P01DATA5,79,2)='73' THEN SUBSTR(P01DATA5,74,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND SUBSTR(P01DATA6,79,2)='73' THEN SUBSTR(P01DATA6,74,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND SUBSTR(P01DATA7,79,2)='73' THEN SUBSTR(P01DATA7,74,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND SUBSTR(P01DATA8,79,2)='73' THEN SUBSTR(P01DATA8,74,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND SUBSTR(P01DATA9,79,2)='73' THEN SUBSTR(P01DATA9,74,5)	ELSE '' END ||''||
															
															CASE WHEN SUBSTR(P01DATA1,1,1)='1' AND SUBSTR(P01DATA1,22,2)='73' THEN SUBSTR(P01DATA1,17,5)  	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA2,1,1)='1' AND SUBSTR(P01DATA2,22,2)='73' THEN SUBSTR(P01DATA2,17,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA3,1,1)='1' AND SUBSTR(P01DATA3,22,2)='73' THEN SUBSTR(P01DATA3,17,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA4,1,1)='1' AND SUBSTR(P01DATA4,22,2)='73' THEN SUBSTR(P01DATA4,17,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA5,1,1)='1' AND SUBSTR(P01DATA5,22,2)='73' THEN SUBSTR(P01DATA5,17,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA6,1,1)='1' AND SUBSTR(P01DATA6,22,2)='73' THEN SUBSTR(P01DATA6,17,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA7,1,1)='1' AND SUBSTR(P01DATA7,22,2)='73' THEN SUBSTR(P01DATA7,17,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA8,1,1)='1' AND SUBSTR(P01DATA8,22,2)='73' THEN SUBSTR(P01DATA8,17,5)	ELSE '' END ||''||
															CASE WHEN SUBSTR(P01DATA9,1,1)='1' AND SUBSTR(P01DATA9,22,2)='73' THEN SUBSTR(P01DATA9,17,5)	ELSE '' END,1,5)

	 	WHERE P01HSYY=substr(#{startDt},1,4) and P01HSMM=substr(#{startDt},5,2) and P01HSDD =substr(#{startDt},7,2)  AND 
		 P01HSCD=#{jum} AND 
			--AND P01HRNO='7281'   --포스번호

	 
			(	
				(SUBSTR(P01DATA1,1,1)='1' AND SUBSTR(P01DATA1,22,2)='73')
			OR	(SUBSTR(P01DATA2,1,1)='1' AND SUBSTR(P01DATA2,22,2)='73')
			OR	(SUBSTR(P01DATA3,1,1)='1' AND SUBSTR(P01DATA3,22,2)='73')
			OR	(SUBSTR(P01DATA4,1,1)='1' AND SUBSTR(P01DATA4,22,2)='73')
			OR	(SUBSTR(P01DATA5,1,1)='1' AND SUBSTR(P01DATA5,22,2)='73')
			OR	(SUBSTR(P01DATA6,1,1)='1' AND SUBSTR(P01DATA6,22,2)='73')
			OR	(SUBSTR(P01DATA7,1,1)='1' AND SUBSTR(P01DATA7,22,2)='73')
			OR	(SUBSTR(P01DATA8,1,1)='1' AND SUBSTR(P01DATA8,22,2)='73')
			OR	(SUBSTR(P01DATA9,1,1)='1' AND SUBSTR(P01DATA9,22,2)='73')
			OR	(SUBSTR(P01DATA1,1,1)='1' AND SUBSTR(P01DATA1,79,2)='73')
			OR	(SUBSTR(P01DATA2,1,1)='1' AND SUBSTR(P01DATA2,79,2)='73')
			OR	(SUBSTR(P01DATA3,1,1)='1' AND SUBSTR(P01DATA3,79,2)='73')
			OR	(SUBSTR(P01DATA4,1,1)='1' AND SUBSTR(P01DATA4,79,2)='73')
			OR	(SUBSTR(P01DATA5,1,1)='1' AND SUBSTR(P01DATA5,79,2)='73')
			OR	(SUBSTR(P01DATA6,1,1)='1' AND SUBSTR(P01DATA6,79,2)='73')
			OR	(SUBSTR(P01DATA7,1,1)='1' AND SUBSTR(P01DATA7,79,2)='73')
			OR	(SUBSTR(P01DATA8,1,1)='1' AND SUBSTR(P01DATA8,79,2)='73')
			OR	(SUBSTR(P01DATA9,1,1)='1' AND SUBSTR(P01DATA9,79,2)='73')
			)
			--코너검색
			<if test="coner !=''">
			AND
			(
				(	SUBSTR(P01DATA1,74,5)=#{coner}
				OR	SUBSTR(P01DATA2,74,5)=#{coner}
				OR	SUBSTR(P01DATA3,74,5)=#{coner}
				OR	SUBSTR(P01DATA4,74,5)=#{coner}
				OR	SUBSTR(P01DATA5,74,5)=#{coner}
				OR	SUBSTR(P01DATA6,74,5)=#{coner}
				OR	SUBSTR(P01DATA7,74,5)=#{coner}
				OR	SUBSTR(P01DATA8,74,5)=#{coner}
				OR	SUBSTR(P01DATA9,74,5)=#{coner}
				)
	
			OR
				(	SUBSTR(P01DATA1,17,5)=#{coner}
				OR	SUBSTR(P01DATA2,17,5)=#{coner}
				OR	SUBSTR(P01DATA3,17,5)=#{coner}
				OR	SUBSTR(P01DATA4,17,5)=#{coner}
				OR	SUBSTR(P01DATA5,17,5)=#{coner}
				OR	SUBSTR(P01DATA6,17,5)=#{coner}
				OR	SUBSTR(P01DATA7,17,5)=#{coner}
				OR	SUBSTR(P01DATA8,17,5)=#{coner}
				OR	SUBSTR(P01DATA9,17,5)=#{coner}
				)
			)   
			</if>
	ORDER BY P01HSYY,P01HSMM,P01HSDD,P01HRNO
		
	</select>
	<select id="selectTrLogConerSaleInqListCredit" resultType="com.saydept.api.spf.selng.selngrcpt.trLogConerSaleInq.model.TrLogConerSaleInqModel" 
											parameterType="com.saydept.api.spf.selng.selngrcpt.trLogConerSaleInq.model.TrLogConerSaleInqParamModel" fetchSize="1000">
	
	
	SELECT 	P01HSYY||'년'||P01HSMM||'월'||P01HSDD||'일' dt,P01HRNO Regi,P01HTNO Recipt
	
		,
		(
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' THEN INT(SUBSTR(P01DATA1,38,7))   ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' THEN INT(SUBSTR(P01DATA2,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' THEN INT(SUBSTR(P01DATA3,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' THEN INT(SUBSTR(P01DATA4,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' THEN INT(SUBSTR(P01DATA5,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' THEN INT(SUBSTR(P01DATA6,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' THEN INT(SUBSTR(P01DATA7,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' THEN INT(SUBSTR(P01DATA8,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' THEN INT(SUBSTR(P01DATA9,38,7))	ELSE 0 END )*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END AS discount
			
		
		,
		((
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' THEN INT(SUBSTR(P01DATA1,24,8))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' THEN INT(SUBSTR(P01DATA2,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' THEN INT(SUBSTR(P01DATA3,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' THEN INT(SUBSTR(P01DATA4,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' THEN INT(SUBSTR(P01DATA5,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' THEN INT(SUBSTR(P01DATA6,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' THEN INT(SUBSTR(P01DATA7,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' THEN INT(SUBSTR(P01DATA8,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' THEN INT(SUBSTR(P01DATA9,24,8))	ELSE 0 END )*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END)-	
		((
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' THEN INT(SUBSTR(P01DATA1,38,7))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' THEN INT(SUBSTR(P01DATA2,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' THEN INT(SUBSTR(P01DATA3,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' THEN INT(SUBSTR(P01DATA4,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' THEN INT(SUBSTR(P01DATA5,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' THEN INT(SUBSTR(P01DATA6,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' THEN INT(SUBSTR(P01DATA7,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' THEN INT(SUBSTR(P01DATA8,38,7))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' THEN INT(SUBSTR(P01DATA9,38,7))	ELSE 0 END )*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END) AS netSale
		,

		(
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' THEN INT(SUBSTR(P01DATA1,24,8))  ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' THEN INT(SUBSTR(P01DATA2,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' THEN INT(SUBSTR(P01DATA3,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' THEN INT(SUBSTR(P01DATA4,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' THEN INT(SUBSTR(P01DATA5,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' THEN INT(SUBSTR(P01DATA6,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' THEN INT(SUBSTR(P01DATA7,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' THEN INT(SUBSTR(P01DATA8,24,8))	ELSE 0 END +
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' THEN INT(SUBSTR(P01DATA9,24,8))	ELSE 0 END )*
		CASE WHEN P01HSGU ='1' THEN -1
			 WHEN P01HSGU ='0' THEN	1 	ELSE 0 END AS totSale
		,
	
		CASE WHEN SUBSTR(P01DATA1,1,1)='1' THEN SUBSTR(P01DATA1,17,5)  	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA2,1,1)='1' THEN SUBSTR(P01DATA2,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA3,1,1)='1' THEN SUBSTR(P01DATA3,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA4,1,1)='1' THEN SUBSTR(P01DATA4,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA5,1,1)='1' THEN SUBSTR(P01DATA5,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA6,1,1)='1' THEN SUBSTR(P01DATA6,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA7,1,1)='1' THEN SUBSTR(P01DATA7,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA8,1,1)='1' THEN SUBSTR(P01DATA8,17,5)	ELSE '' END ||''||
		CASE WHEN SUBSTR(P01DATA9,1,1)='1' THEN SUBSTR(P01DATA9,17,5)	ELSE '' END  
		,
		CASE WHEN P01HSGU ='0' THEN '정상'
			  WHEN P01HSGU ='1' THEN '반품'	ELSE ''END AS div
		,TRIM(MS0510) AS conerNm
		
		FROM SPOTNRDB.SPOPF01
			LEFT OUTER JOIN SPFRDB.SPFM05PF 
		ON MS0501='01' AND MS0505=	SUBSTR(	CASE WHEN SUBSTR(P01DATA1,1,1)='1' THEN SUBSTR(P01DATA1,17,5)  	ELSE '' END ||''||
											CASE WHEN SUBSTR(P01DATA2,1,1)='1' THEN SUBSTR(P01DATA2,17,5)	ELSE '' END ||''||
											CASE WHEN SUBSTR(P01DATA3,1,1)='1' THEN SUBSTR(P01DATA3,17,5)	ELSE '' END ||''||
											CASE WHEN SUBSTR(P01DATA4,1,1)='1' THEN SUBSTR(P01DATA4,17,5)	ELSE '' END ||''||
											CASE WHEN SUBSTR(P01DATA5,1,1)='1' THEN SUBSTR(P01DATA5,17,5)	ELSE '' END ||''||
											CASE WHEN SUBSTR(P01DATA6,1,1)='1' THEN SUBSTR(P01DATA6,17,5)	ELSE '' END ||''||
											CASE WHEN SUBSTR(P01DATA7,1,1)='1' THEN SUBSTR(P01DATA7,17,5)	ELSE '' END ||''||
											CASE WHEN SUBSTR(P01DATA8,1,1)='1' THEN SUBSTR(P01DATA8,17,5)	ELSE '' END ||''||
											CASE WHEN SUBSTR(P01DATA9,1,1)='1' THEN SUBSTR(P01DATA9,17,5)	ELSE '' END,1,5)
											
		 WHERE P01HSYY=substr(#{startDt},1,4) and P01HSMM=substr(#{startDt},5,2) and P01HSDD =substr(#{startDt},7,2) AND 
		 P01HSCD=#{jum} AND (P01HSG1='4' OR P01HSG2='4' OR P01HSG3='4' OR P01HSG4='4' OR P01HSG5='4')
	
	
			<if test="coner !=''">
					AND
					(
						(	SUBSTR(P01DATA1,74,5)=#{coner}
						OR	SUBSTR(P01DATA2,74,5)=#{coner}
						OR	SUBSTR(P01DATA3,74,5)=#{coner}
						OR	SUBSTR(P01DATA4,74,5)=#{coner}
						OR	SUBSTR(P01DATA5,74,5)=#{coner}
						OR	SUBSTR(P01DATA6,74,5)=#{coner}
						OR	SUBSTR(P01DATA7,74,5)=#{coner}
						OR	SUBSTR(P01DATA8,74,5)=#{coner}
						OR	SUBSTR(P01DATA9,74,5)=#{coner}
						)
			
					OR
						(	SUBSTR(P01DATA1,17,5)=#{coner}
						OR	SUBSTR(P01DATA2,17,5)=#{coner}
						OR	SUBSTR(P01DATA3,17,5)=#{coner}
						OR	SUBSTR(P01DATA4,17,5)=#{coner}
						OR	SUBSTR(P01DATA5,17,5)=#{coner}
						OR	SUBSTR(P01DATA6,17,5)=#{coner}
						OR	SUBSTR(P01DATA7,17,5)=#{coner}
						OR	SUBSTR(P01DATA8,17,5)=#{coner}
						OR	SUBSTR(P01DATA9,17,5)=#{coner}
						)
					)   
			</if>
		ORDER BY P01HSYY,P01HSMM,P01HSDD,P01HRNO
	</select>
</mapper>